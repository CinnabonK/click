<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choir Practice</title>
    <link rel="icon" href="images/favicon.ico" type="image/x-icon"> <!-- favicon設定 -->
    <style>
        /* 既存のCSSはそのまま */
    </style>
</head>
<body>

    <header>
        <h1>Choir Practice</h1>
        <p>Click on a song to start practice</p>
    </header>

    <div class="music-card" onclick="playSong('song1')">
        <img src="images/song1.jpg" alt="Song 1">
        <h3>Song 1</h3>
    </div>
    <div class="music-card" onclick="playSong('song2')">
        <img src="images/song2.jpg" alt="Song 2">
        <h3>Song 2</h3>
    </div>
    <div class="music-card" onclick="playSong('song3')">
        <img src="images/song3.jpg" alt="Song 3">
        <h3>Song 3</h3>
    </div>

    <div id="music-player" class="music-player">
        <video id="video-player" controls>
            <!-- MP4ファイルのURLは動的に設定される -->
        </video>
        <div class="controls">
            <label for="volume">Volume (up to 500%):</label>
            <input type="range" id="volume" min="0" max="500" value="100" oninput="adjustVolume()">
            <br>
            <label for="speed">Playback Speed:</label>
            <input type="range" id="speed" min="0.5" max="2" step="0.1" value="1" oninput="adjustSpeed()">
            <br>
            <label for="seek">Seek:</label>
            <input type="range" id="seek" min="0" value="0" oninput="adjustSeek()">
        </div>

        <button class="back-button" onclick="closePlayer()">Back to Songs</button>
        <div id="error-message" class="error-message"></div>
    </div>

    <script>
        let videoPlayer = document.getElementById('video-player');
        let volumeSlider = document.getElementById('volume');
        let speedSlider = document.getElementById('speed');
        let seekSlider = document.getElementById('seek');
        let errorMessage = document.getElementById('error-message');

        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const gainNode = audioContext.createGain();
        const source = audioContext.createMediaElementSource(videoPlayer);
        source.connect(gainNode);
        gainNode.connect(audioContext.destination);

        function playSong(song) {
            document.getElementById('music-player').style.display = 'flex';
            errorMessage.textContent = '';
            videoPlayer.src = `https://your-username.github.io/your-repo-path/${song}.mp4`; // GitHub PagesのURLに変更
            volumeSlider.value = 100;
            speedSlider.value = 1;
            seekSlider.value = 0;
            gainNode.gain.value = 1;
            videoPlayer.playbackRate = 1;

            videoPlayer.onloadedmetadata = function() {
                seekSlider.max = videoPlayer.duration;
            };

            videoPlayer.onerror = function() {
                errorMessage.textContent = 'Error: Unable to load the video. Please check the file or try again later.';
            };
        }

        function closePlayer() {
            document.getElementById('music-player').style.display = 'none';
            videoPlayer.pause();
        }

        function adjustVolume() {
            let volumeValue = volumeSlider.value / 500;
            gainNode.gain.value = volumeValue * 5;
        }

        function adjustSpeed() {
            videoPlayer.playbackRate = speedSlider.value;
        }

        function adjustSeek() {
            videoPlayer.currentTime = seekSlider.value;
        }

        videoPlayer.ontimeupdate = function() {
            seekSlider.value = videoPlayer.currentTime;
        };
    </script>

</body>
</html>
